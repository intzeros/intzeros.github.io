<!DOCTYPE html>
<html lang="en-US">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <title>
    
      计算几何 &middot; Soki's Blog
    
  </title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="/assets/bootstrap-3.3.7-dist/css/bootstrap.min.css">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="/assets/css/font-awesome.min.css">
  <!-- My CSS -->
  <link rel="stylesheet" href="/assets/main.css">

  <!-- MathJax -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      TeX: {
        equationNumbers: {
          autoNumber: "AMS"
        }
      },
      tex2jax: {
        inlineMath: [ ['$','$'] ],
        displayMath: [ ['$$','$$'] ],
        processEscapes: true,
      }
    });
  </script>
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  

  <!-- code highlighting-->
  <link rel="stylesheet" href="/lib/highlight/styles/hybrid.css">
  <script src="/lib/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script>hljs.configure({ ignore: ['text'] });</script>
  
  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>

<body>
    <header class="header">
  <!-- Navigation -->
  <nav class="navbar navbar-default .navbar-static-top">
    <div class="container">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/" style="color:#333">Soki's Blog</a>
        <p class="navbar-text">God does not play dice.</p>
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav navbar-right">
          <li class="nav-search">
            <form class="navbar-form navbar-left" role="search">
              <div class="input-group">
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="button" style="color:#777">Go!</button>
                  </span>
                  <input type="text" class="form-control" placeholder="Search">
              </div>
            </form>
          </li>
          <li>
            <a href="#">Archives</a>
          </li>
          <li>
            <a href="#">Links</a>
          </li>
          <li>
            <a href="#">About</a>
          </li>
        </ul>
      </div>
      <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
  </nav>
</header>

  
    <div class="container">
  <div class="row-fluid main">
    <div class="content col-md-9">
      <article class="post">
        <h1 class="post-title">计算几何</h1>
        <hr />
        <h2 id="点和线">点和线</h2>
<h3 id="基础">基础</h3>
<p>向量  $\vec{a} = (x_1, y_1), \vec{b} = (x_2, y_2)$.</p>

<p>(1) <strong>点积</strong>:  <script type="math/tex">\vec{a}\cdot \vec{b} = x_1x_2 + y_1y_2 = \vert a \vert \vert b \vert cos\theta</script></p>

<p>(2) <strong>叉积</strong> (cross product):
<img src="http://lszero.com/wp-content/uploads/2017/04/Screen-Shot-2017-04-27-at-11.20.09-AM.png" style="zoom:50%; float:right" /></p>

<p><script type="math/tex">% <![CDATA[
\vert \vec{a}\times \vec{b} \vert = det\begin{bmatrix}x_1 & x_2 \\y_1 & y_2 \end{bmatrix}= x_1y_2 - x_2y_1 = \vert a \vert \vert b \vert sin\theta %]]></script>.</p>

<p>$\vec{a}\times \vec{b} =  - \vec{b}\times \vec{a}$</p>

<p>看作由点(0, 0), $\vec{a}$, $\vec{b}$ 和 $\vec{a}+\vec{b}=(x_1+x_2, y_1+y_2)$所形成的平行四边形的有向面积.</p>

<p><strong>右手</strong>定则判断方向.</p>

<p>(3) 向量 $\vec{a}, \vec{b}$ <strong>共线</strong>:  $\vec{a}\times \vec{b} = x_1y_2 - x_2y_1 = 0$</p>

<p>向量 $\vec{a}, \vec{b}$ <strong>垂直</strong>:  $\vec{a}\cdot \vec{b} = x_1x_2 + y_1y_2 = 0$</p>

<p>(4) 点 $P_1 = (x_1, y_1), P2 = (x_2, y_2)$, 则 $\overrightarrow{P_1P_2} = (x_2-x_1, y_2-y_1)$.</p>

<p>(5) 判断三点共线: <code class="highlighter-rouge">叉乘==0</code>.</p>

<p>(6) 判断点P在线段$P_1P_2$上:</p>

<p><code class="highlighter-rouge">叉乘==0 &amp;&amp; (P1.x-P.x)*(P2.x-P.x)&lt;0 &amp;&amp; (P1.y-P.y)*(P2.y-P.y)&lt;0</code></p>

<p>(7) 判断两直线平行: <code class="highlighter-rouge">叉乘==0</code>.</p>

<!-- more -->

<h3 id="点相对有向线段的方向">点相对有向线段的方向</h3>

<p>(1) 判断点P2相对于有向线段$\overrightarrow{P_0P_1}$ 的方向:</p>

<p>通过计算$\overrightarrow{P_0P_1}\times \overrightarrow{P_0P_2}$的结果为正还是为负.</p>

<p>(2) 在P1处，两条连续的有向线段$\overrightarrow{P_0P_1}$ 和$\overrightarrow{P_1P_2}$ 是向左转还是向右转: 同上述问题(1).
<img src="http://lszero.com/wp-content/uploads/2017/04/Screen-Shot-2017-04-27-at-12.27.01-PM.png" style="zoom:50%" /></p>

<p>(3) 判断两条线段相交:
点P1和点P2分别在$\overrightarrow{P_3P_4}$的两个不同方向 <strong>&amp;&amp;</strong> 点P3和点P4分别在$\overrightarrow{P_1P_2}$的两个不同方向.
特殊情况: 仅有一个端点在另一条线段上.
<img src="http://lszero.com/wp-content/uploads/2017/04/Screen-Shot-2017-04-27-at-12.53.42-PM.png" style="zoom:25%" /></p>

<p>(4) 判断线段与直线相交: 同理.</p>

<h3 id="常用代码模板">常用代码模板</h3>

<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="c1">// 计算 向量p0p1 叉乘 向量p0p2
</span><span class="kt">double</span> <span class="n">xmulti</span><span class="p">(</span><span class="n">Point</span> <span class="n">p0</span><span class="p">,</span> <span class="n">Point</span> <span class="n">p1</span><span class="p">,</span> <span class="n">Point</span> <span class="n">p2</span><span class="p">){</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="n">p0</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p2</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="n">p0</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">p2</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="n">p0</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="n">p0</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
</div>

<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="c1">// 判断三点共线
</span><span class="kt">bool</span> <span class="n">collinear</span><span class="p">(</span><span class="n">Point</span> <span class="n">p1</span><span class="p">,</span> <span class="n">Point</span> <span class="n">p2</span><span class="p">,</span> <span class="n">Point</span> <span class="n">p3</span><span class="p">){</span>
    <span class="kt">double</span> <span class="n">rst</span> <span class="o">=</span> <span class="n">xmulti</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">fabs</span><span class="p">(</span><span class="n">rst</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-8</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="c1">// 判断点p是否在线段p1p2上(包括端点)
</span><span class="kt">bool</span> <span class="n">dot_online</span><span class="p">(</span><span class="n">Point</span> <span class="n">p</span><span class="p">,</span> <span class="n">Point</span> <span class="n">p1</span><span class="p">,</span> <span class="n">Point</span> <span class="n">p2</span><span class="p">){</span>
    <span class="kt">double</span> <span class="n">d</span> <span class="o">=</span> <span class="n">xmulti</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">fabs</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-8</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p2</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="n">p</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p2</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="n">p</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="c1">// 判断两条线段相交(包括仅有一个端点在另一条线段上的情况)
</span><span class="kt">bool</span> <span class="n">intersection</span><span class="p">(</span><span class="n">Point</span> <span class="n">p1</span><span class="p">,</span> <span class="n">Point</span> <span class="n">p2</span><span class="p">,</span> <span class="n">Point</span> <span class="n">p3</span><span class="p">,</span> <span class="n">Point</span> <span class="n">p4</span><span class="p">){</span>
    <span class="kt">double</span> <span class="n">d1</span> <span class="o">=</span> <span class="n">xmulti</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">,</span> <span class="n">p1</span><span class="p">);</span> <span class="c1">// p1相对于p3p4
</span>    <span class="kt">double</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">xmulti</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">,</span> <span class="n">p2</span><span class="p">);</span>
    <span class="kt">double</span> <span class="n">d3</span> <span class="o">=</span> <span class="n">xmulti</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">);</span>
    <span class="kt">double</span> <span class="n">d4</span> <span class="o">=</span> <span class="n">xmulti</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p4</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">d1</span><span class="o">*</span><span class="n">d2</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">d3</span><span class="o">*</span><span class="n">d4</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-8</span> <span class="o">&amp;&amp;</span> <span class="n">dot_online</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">))</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-8</span> <span class="o">&amp;&amp;</span> <span class="n">dot_online</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">))</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">d3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-8</span> <span class="o">&amp;&amp;</span> <span class="n">dot_online</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">))</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">d4</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-8</span> <span class="o">&amp;&amp;</span> <span class="n">dot_online</span><span class="p">(</span><span class="n">p4</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">))</span> <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="凸包-convex-hull">凸包 Convex Hull</h2>

<h3 id="graham扫描法求凸包">Graham扫描法求凸包</h3>

<p><strong>时间复杂度: O(nlogn)</strong> (主要是排序)
空间复杂度: stack.</p>

<hr />

<p>过程: (poj 1113 Wall)
<img src="https://upload.wikimedia.org/wikipedia/commons/7/71/GrahamScanDemo.gif" style="zoom:50%; float:right" /></p>

<p>(1) 确定坐标原点 v[0]: 选 y值 最小的点.</p>

<p>(2) 将剩余点按 <strong>极角</strong> 排序, 对极角相同的点按据v[0]的远近排序.
按 <strong>极角</strong> 排序, 即按 <strong>叉乘</strong>的值 排序: 
若 v[0]v[j] × v[0]v[i] &gt; 0, 即意味着 点v[j]在v[0]v[i]的顺时针方向. 在 cmp函数中, 因为返回值为正, 也就把 v[i]排在 v[j]之前.</p>

<p>(3) v[0], v[1] 入栈.</p>

<p>(4) 依次扫描之后遇到的每个点 v[i]:
​	若stack.size()&gt;=2, 检查 v[i] 相对于栈顶两个点构成的有向线段的方向.</p>

<p>(5) 栈中元素即求出的凸包顶点.</p>

<hr />

<p>代码:</p>

<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span>

<span class="c1">// 计算 向量p0p1 叉乘 向量p0p2
</span><span class="kt">double</span> <span class="n">xmulti</span><span class="p">(</span><span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">p0</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">p1</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">p2</span><span class="p">){</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="n">p0</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p2</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="n">p0</span><span class="p">.</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">p2</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="n">p0</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="n">p0</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="n">dis</span><span class="p">(</span><span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">p1</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">p2</span><span class="p">){</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="n">p2</span><span class="p">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">x</span><span class="o">-</span><span class="n">p2</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="n">p2</span><span class="p">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">y</span><span class="o">-</span><span class="n">p2</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">cmp</span><span class="p">(</span><span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">p1</span><span class="p">,</span> <span class="k">const</span> <span class="n">Point</span> <span class="o">&amp;</span><span class="n">p2</span><span class="p">){</span>
    <span class="kt">double</span> <span class="n">d</span> <span class="o">=</span> <span class="n">xmulti</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-8</span><span class="p">)</span> <span class="k">return</span> <span class="n">dis</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">dis</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">d</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">Graham</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">){</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">stk</span><span class="p">;</span>
    <span class="n">stk</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="n">stk</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">while</span><span class="p">(</span><span class="n">stk</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">xmulti</span><span class="p">(</span><span class="n">stk</span><span class="p">[</span><span class="n">stk</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">stk</span><span class="p">[</span><span class="n">stk</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
            <span class="n">stk</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="n">stk</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span> 
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">stk</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(){</span>
    <span class="c1">// cin...
</span>    <span class="kt">double</span> <span class="n">min</span> <span class="o">=</span> <span class="mf">1e9</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">min</span><span class="p">)</span> <span class="n">min</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">swap</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">pos</span><span class="p">]);</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">cmp</span><span class="p">);</span>

    <span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="n">rst</span> <span class="o">=</span> <span class="n">Graham</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<h3 id="凸包面积">凸包面积</h3>

<p>(1) 三角形面积</p>

<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="c1">// 计算三角形面积, 输入三顶点
</span><span class="kt">double</span> <span class="n">area_triangle</span><span class="p">(</span><span class="n">Point</span> <span class="n">p1</span><span class="p">,</span> <span class="n">Point</span> <span class="n">p2</span><span class="p">,</span> <span class="n">Point</span> <span class="n">p3</span><span class="p">){</span>
    <span class="k">return</span> <span class="n">fabs</span><span class="p">(</span><span class="n">xmult</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">p3</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> 
<span class="p">}</span>
</code></pre>
</div>

<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="c1">// 计算三角形面积, 输入三边长
</span><span class="kt">double</span> <span class="n">area_triangle</span><span class="p">(</span><span class="kt">double</span> <span class="n">a</span><span class="p">,</span> <span class="kt">double</span> <span class="n">b</span><span class="p">,</span> <span class="kt">double</span> <span class="n">c</span><span class="p">){</span>
    <span class="kt">double</span> <span class="n">s</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="n">c</span><span class="p">));</span>
<span class="p">}</span>
</code></pre>
</div>

<p>(2) 凸包面积 (poj 3348 Cows)</p>

<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="c1">// 计算多边形面积, 顶点按顺时针或逆时针给出
</span><span class="kt">double</span> <span class="n">area_polygon</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;&amp;</span> <span class="n">v</span><span class="p">){</span>
    <span class="kt">double</span> <span class="n">rst</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">rst</span> <span class="o">+=</span> <span class="n">area_triangle</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">rst</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="最近点对">最近点对</h2>

<pre><code class="language-text">求二维平面上的最近点对. 详见《编程之美》-&gt; 分治思想.
</code></pre>

<p>​(:smile: 不是说不贴代码就不重要…:smile: )</p>

<hr />

<p>扩展问题:</p>

<pre><code class="language-text">给定一个无序数组, 求排序后相邻两个元素的最大差值. (leetcode 164) 解法1: 分治
</code></pre>

<p>解法2: 桶排序</p>

<pre><code class="language-text">求二维平面上的最远点对. 思路: 先求凸包, 后求凸包直径.
</code></pre>

<h3 id="求凸包直径-旋转卡壳算法-rotating-calipers">求凸包直径: 旋转卡壳算法 (Rotating Calipers)</h3>

<p><img src="http://lszero.com/wp-content/uploads/2017/04/2011040318073013.gif" style="zoom:50%; float:right" /></p>

<p>用两条平行线去卡住凸包, 被卡住的两个顶点称为<a href="http://blog.csdn.net/acmaker/article/details/3561145"><strong>对踵点对</strong></a>.</p>

<p>最远点对一定是对踵点对, 而对踵点对的个数为 O(n), 这就说明了解决问题的复杂度.</p>

<p><img src="http://lszero.com/wp-content/uploads/2017/04/diam.gif" style="zoom:70%" /></p>

<p>一般情况下, 平行线是卡住两个顶点. 为了方便处理, 采用卡住一条边和一个顶点的方式.</p>

<p>于是思路为, 枚举凸包上的所有边, 对每条边再找出距离该边最远的顶点, 这样看似是个O(n^2)的算法, 和直接枚举两个顶点没什么优势. 但是注意到当我们逆时针枚举边和点的时候, 因为对踵点到固定边的的距离比其他点到固定边的距离都要大, 而且是单调递增的, 所有没必要每次从头枚举, 而是接着上一次对踵点的位置开始.
<img src="http://lszero.com/wp-content/uploads/2017/04/appve.gif" /></p>

<p>代码: (参考 <a href="http://www.cppblog.com/staryjy/archive/2009/11/19/101412.html">here</a>)</p>

<div class="language-c++ highlighter-rouge"><pre class="highlight"><code><span class="c1">//计算凸包直径，输入凸包ch，顶点个数为n，按逆时针排列，输出直径的平方
</span><span class="kt">int</span> <span class="nf">rotating_calipers</span><span class="p">(</span><span class="n">Point</span> <span class="o">*</span><span class="n">ch</span><span class="p">,</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">q</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="n">ch</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">ch</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">p</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">p</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">while</span><span class="p">(</span><span class="n">cross</span><span class="p">(</span><span class="n">ch</span><span class="p">[</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">ch</span><span class="p">[</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">ch</span><span class="p">[</span><span class="n">p</span><span class="p">])</span><span class="o">&gt;</span><span class="n">cross</span><span class="p">(</span><span class="n">ch</span><span class="p">[</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">ch</span><span class="p">[</span><span class="n">q</span><span class="p">],</span><span class="n">ch</span><span class="p">[</span><span class="n">p</span><span class="p">]))</span>
            <span class="n">q</span><span class="o">=</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">n</span><span class="p">;</span>
        <span class="n">ans</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span><span class="n">max</span><span class="p">(</span><span class="n">dist2</span><span class="p">(</span><span class="n">ch</span><span class="p">[</span><span class="n">p</span><span class="p">],</span><span class="n">ch</span><span class="p">[</span><span class="n">q</span><span class="p">]),</span><span class="n">dist2</span><span class="p">(</span><span class="n">ch</span><span class="p">[</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">ch</span><span class="p">[</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">])));</span>            
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span> 
<span class="p">}</span>
</code></pre>
</div>

<p>其中cross函数是计算叉积，可以想成是计算三角形面积，因为凸包上距离一条边最远的点和这条边的两个端点构成的三角形面积是最大的。之所以既要更新(ch[p],ch[q])又要更新(ch[p+1],ch[q+1])是为了处理凸包上两条边平行的特殊情况。</p>

<h3 id="凸包最近点对">凸包最近点对</h3>

<p>…</p>

<h3 id="找最小圆覆盖平面所有点">找最小圆覆盖平面所有点</h3>

<p>…</p>

<h2 id="三角剖分"><strong>三角剖分</strong></h2>

<p>待补充…</p>

        <br><br>

        <footer class="post-meta">
          <div class="post-info">
            <a class="author" href="http://localhost:4000">lszero</a>
            <time class="post-date"><a href="">27 Apr 2017</a></time>
            <a class="category" href="#">类别</a>
            <a class="comments" href="#">No Comments</a>
          </div>
          <hr />
        </footer>
      </article>

      
      <aside class="related">
        <h3>Related Posts</h3>
        <ul class="related-posts">
          
            <li>
              <a href="/coding4fun/static-website-with-jekyll.html">
                从WordPress到静态网站
                <small><time datetime="2017-08-01T20:00:00+08:00">01 Aug 2017</time></small>
              </a>
            </li>
          
            <li>
              <a href="/algorithm/alibaba-interview-201704.html">
                阿里笔试两道编程题
                <small><time datetime="2017-04-26T18:36:00+08:00">26 Apr 2017</time></small>
              </a>
            </li>
          
            <li>
              <a href="/algorithm/reservoir-sampling.html">
                水塘抽样
                <small><time datetime="2016-10-21T01:30:00+08:00">21 Oct 2016</time></small>
              </a>
            </li>
          
        </ul>
      </aside>
      
    </div>
    
    <div class="sidebar-content col-md-3">
      <div class="post-sidebar">
  <nav class="header-list-sidebar">
    <ul id="sideNav" class="nav headers-sidenav">
        <!-- code will be generated in TOC.js -->
    </ul>

    <a href="#top" class="back-to-top">^</a>
  </nav>
</div>
    </div>
  </div>
</div>


    <footer class="footer">
  <div class="copyright">
      Copyright &copy; <time datetime="2017-08-06T03:00:58+08:00">2017</time> <a href="http://localhost:4000">lszero</a> | Powered by <a href="https://github.com/jekyll/jekyll">Jekyll</a> | Designed by <a href="http://localhost:4000">lszero</a>
  </div>
</footer>

<!--      -->

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="/assets/js/jquery-1.12.4.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/assets/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
    <!-- TOC -->
    <script src="/assets/js/toc/TOC.js"></script>
  </body>
</html>
